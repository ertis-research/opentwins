"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[981],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),p=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=p(e.components);return a.createElement(u.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,u=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=p(n),c=r,g=m["".concat(u,".").concat(c)]||m[c]||d[c]||i;return n?a.createElement(g,o(o({ref:t},s),{},{components:n})):a.createElement(g,o({ref:t},s))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=c;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l[m]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},2308:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const i={sidebar_position:2},o="From Grafana to Unity",l={unversionedId:"guides/unity/grafana-to-unity",id:"guides/unity/grafana-to-unity",title:"From Grafana to Unity",description:"Before proceeding, make sure you meet the requirements and have completed the base configuration.",source:"@site/docs/guides/unity/grafana-to-unity.mdx",sourceDirName:"guides/unity",slug:"/guides/unity/grafana-to-unity",permalink:"/opentwins/docs/guides/unity/grafana-to-unity",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/guides/unity/grafana-to-unity.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Base configuration",permalink:"/opentwins/docs/guides/unity/base-config"},next:{title:"From Unity to Grafana",permalink:"/opentwins/docs/guides/unity/unity-to-grafana"}},u={},p=[{value:"In Unity",id:"in-unity",level:2},{value:"In Grafana",id:"in-grafana",level:2},{value:"How data is sent",id:"how-data-is-sent",level:2},{value:"Mode: Send All Data to a Single GameObject",id:"mode-send-all-data-to-a-single-gameobject",level:4},{value:"Mode: Send Data to GameObjects by ID Column",id:"mode-send-data-to-gameobjects-by-id-column",level:4},{value:"Grouping Data",id:"grouping-data",level:4}],s={toc:p},m="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"from-grafana-to-unity"},"From Grafana to Unity"),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("p",{parentName:"admonition"},"Before proceeding, make sure you meet the ",(0,r.kt)("a",{parentName:"p",href:"/opentwins/docs/guides/unity/base-config#requirements"},(0,r.kt)("strong",{parentName:"a"},"requirements"))," and have completed the ",(0,r.kt)("a",{parentName:"p",href:"/opentwins/docs/guides/unity/base-config"},(0,r.kt)("strong",{parentName:"a"},"base configuration")),".")),(0,r.kt)("p",null,"This page explains how to configure and implement the communication pipeline for sending data ",(0,r.kt)("strong",{parentName:"p"},"from Grafana queries into Unity"),".\nThe Unity Grafana plugin offers flexible options for mapping query results to GameObjects. Depending on your use case, you can:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Send all query results to a single GameObject."),(0,r.kt)("li",{parentName:"ul"},"Distribute values dynamically across multiple GameObjects.")),(0,r.kt)("p",null,"On the Unity side, you must implement a function that receives the incoming data string, parses it as JSON, and applies the logic needed to update your objects or scene."),(0,r.kt)("h2",{id:"in-unity"},"In Unity"),(0,r.kt)("p",null,"To receive and process data from Grafana, you must implement a ",(0,r.kt)("strong",{parentName:"p"},"public function")," in a Unity script and attach it to the GameObjects that will handle the data."),(0,r.kt)("p",null,"The simplest implementation is a function that prints the received data to the Unity Debug Console:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},"using UnityEngine;\n\npublic class ChangeInfo : MonoBehaviour\n{\n    public void SetValues(string values)\n    {\n        Debug.Log(values);\n    }\n}\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The function name (",(0,r.kt)("inlineCode",{parentName:"li"},"SetValues")," in this example) must match the name configured in the plugin."),(0,r.kt)("li",{parentName:"ul"},"The function parameter type must be ",(0,r.kt)("inlineCode",{parentName:"li"},"string"),".")),(0,r.kt)("p",null,"You can attach this script to a single GameObject (which then distributes the data to other objects) or directly to multiple GameObjects."),(0,r.kt)("h2",{id:"in-grafana"},"In Grafana"),(0,r.kt)("p",null,"In Grafana, configure the ",(0,r.kt)("strong",{parentName:"p"},"Send data to Unity")," section by specifying:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The query identifier that retrieves the data."),(0,r.kt)("li",{parentName:"ul"},"The function name to be invoked in Unity."),(0,r.kt)("li",{parentName:"ul"},"The data transfer mode."),(0,r.kt)("li",{parentName:"ul"},"The relevant field (",(0,r.kt)("inlineCode",{parentName:"li"},"ID column")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"Id game object"),")."),(0,r.kt)("li",{parentName:"ul"},"The columns used for grouping (if any).")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Use the ",(0,r.kt)("strong",{parentName:"p"},"Table view")," to inspect incoming data and confirm its structure.\nYou can also open ",(0,r.kt)("strong",{parentName:"p"},"Query Inspector ",">"," JSON ",">"," Select Source ",">"," Panel data")," to review the exact JSON sent to the plugin.")),(0,r.kt)("p",null,"For more details on available modes and configuration fields, see the ",(0,r.kt)("a",{parentName:"p",href:"/opentwins/docs/guides/unity/plugin-docs"},"Unity plugin options documentation"),"."),(0,r.kt)("h2",{id:"how-data-is-sent"},"How data is sent"),(0,r.kt)("p",null,"When Grafana queries return results, the plugin transforms the table into a JSON structure that Unity can consume.\nThe exact format depends on the plugin mode and whether you enable grouping by one or more fields."),(0,r.kt)("p",null,"The result is always delivered as a string. Unity functions can parse the received string (e.g., using ",(0,r.kt)("strong",{parentName:"p"},"Json.NET"),") and apply logic to update object properties."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"For smaller Unity projects, you can implement the minimal function above (which only prints to the console), connect it to Grafana, and ",(0,r.kt)("strong",{parentName:"p"},"verify the incoming data directly in the browser developer tools"),".")),(0,r.kt)("p",null,"For example, if a query returns the following table:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"time"),(0,r.kt)("th",{parentName:"tr",align:null},"sensorId"),(0,r.kt)("th",{parentName:"tr",align:null},"temperature"),(0,r.kt)("th",{parentName:"tr",align:null},"humidity"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2024-11-05 12:00:00.000"),(0,r.kt)("td",{parentName:"tr",align:null},"A"),(0,r.kt)("td",{parentName:"tr",align:null},"22.1"),(0,r.kt)("td",{parentName:"tr",align:null},"45")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2024-11-05 12:00:00.000"),(0,r.kt)("td",{parentName:"tr",align:null},"B"),(0,r.kt)("td",{parentName:"tr",align:null},"23.4"),(0,r.kt)("td",{parentName:"tr",align:null},"50")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2024-11-10 17:00:00.000"),(0,r.kt)("td",{parentName:"tr",align:null},"A"),(0,r.kt)("td",{parentName:"tr",align:null},"22.3"),(0,r.kt)("td",{parentName:"tr",align:null},"44")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2024-11-10 17:00:00.000"),(0,r.kt)("td",{parentName:"tr",align:null},"B"),(0,r.kt)("td",{parentName:"tr",align:null},"23.6"),(0,r.kt)("td",{parentName:"tr",align:null},"49")))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Timestamps are converted to ",(0,r.kt)("strong",{parentName:"p"},"Epoch UNIX time in milliseconds"),".",(0,r.kt)("br",{parentName:"p"}),"\n","For example, ",(0,r.kt)("inlineCode",{parentName:"p"},"2024-11-05 12:00:00.000")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"p"},"1730808000000"),".")),(0,r.kt)("h4",{id:"mode-send-all-data-to-a-single-gameobject"},"Mode: Send All Data to a Single GameObject"),(0,r.kt)("p",null,"All query results are bundled into one JSON string and sent to the configured GameObject:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n    { "time": "1730808000000 ", "sensorId": "A", "temperature": 22.1, "humidity": 45 },\n    { "time": "1730808000000 ", "sensorId": "B", "temperature": 23.4, "humidity": 50 },\n    { "time": "1731258000000", "sensorId": "A", "temperature": 22.3, "humidity": 44 },\n    { "time": "1731258000000", "sensorId": "B", "temperature": 23.6, "humidity": 49 }\n]\n')),(0,r.kt)("h4",{id:"mode-send-data-to-gameobjects-by-id-column"},"Mode: Send Data to GameObjects by ID Column"),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("p",{parentName:"admonition"},"Ensure that the IDs in the column ",(0,r.kt)("strong",{parentName:"p"},"exactly match")," the identifiers of the GameObjects, including ",(0,r.kt)("strong",{parentName:"p"},"case sensitivity"),".")),(0,r.kt)("p",null,"If ",(0,r.kt)("inlineCode",{parentName:"p"},"sensorId")," is set as the ",(0,r.kt)("strong",{parentName:"p"},"ID column"),", each GameObject receives only its corresponding data."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For GameObject ",(0,r.kt)("strong",{parentName:"p"},"A"),":  "),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n    { "time": "1730808000000", "temperature": 22.1, "humidity": 45 },\n    { "time": "1731258000000", "temperature": 22.3, "humidity": 44 }\n]\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For GameObject ",(0,r.kt)("strong",{parentName:"p"},"B"),":  "),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n{ "time": "1730808000000", "temperature": 23.4, "humidity": 50 },\n{ "time": "1731258000000", "temperature": 23.6, "humidity": 49 }\n]\n')))),(0,r.kt)("h4",{id:"grouping-data"},"Grouping Data"),(0,r.kt)("p",null,"It is often useful to group data by one or more fields before sending it to Unity. This reduces redundancy and produces a more structured JSON."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Grouped by ",(0,r.kt)("inlineCode",{parentName:"li"},"sensorId"),":")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "A": [\n    { "time": "1730808000000", "temperature": 22.1, "humidity": 45 },\n    { "time": "1731258000000", "temperature": 22.3, "humidity": 44 }\n  ],\n  "B": [\n    { "time": "1730808000000", "temperature": 23.4, "humidity": 50 },\n    { "time": "1731258000000", "temperature": 23.6, "humidity": 49 }\n  ]\n}\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Grouped by ",(0,r.kt)("inlineCode",{parentName:"li"},"sensorId")," and then by ",(0,r.kt)("inlineCode",{parentName:"li"},"time"),": ")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "A": {\n    "1730808000000": { "temperature": 22.1, "humidity": 45 },\n    "1731258000000": { "temperature": 22.3, "humidity": 44 }\n  },\n  "B": {\n    "1730808000000": { "temperature": 23.4, "humidity": 50 },\n    "1731258000000": { "temperature": 23.6, "humidity": 49 }\n  }\n}\n')),(0,r.kt)("p",null,"Without grouping, Unity receives a ",(0,r.kt)("strong",{parentName:"p"},"flat list")," of rows (simpler but repetitive).\nWith grouping, Unity receives ",(0,r.kt)("strong",{parentName:"p"},"nested JSON"),", organized by the chosen fields (cleaner and easier to query by ID or timestamp).\nThe choice depends on how you plan to process data in your Unity scripts."))}d.isMDXComponent=!0}}]);